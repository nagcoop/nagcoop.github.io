<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0f12" />
  <title>Nagcoop â€¢ Web Emulator</title>

  <!-- AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4819258401008864" crossorigin="anonymous"></script>

  <!-- Fonte + tema dark -->
  <link href="https://fonts.googleapis.com/css2?family=Metal+Mania&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0f12; --panel:#12171d; --muted:#9aa4af;
      --brand:#ffd166; --accent:#8b5cf6; --line:#9f1239;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:#e5e7eb;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial}
    a{color:#ffd166;text-decoration:none}
    .wrap{max-width:1100px;margin:auto;padding:16px}
    header{border-bottom:2px solid var(--line);background:linear-gradient(180deg,rgba(159,18,57,.15),transparent)}
    .brand{display:flex;align-items:center;gap:12px}
    .brand h1{font-family:'Metal Mania', cursive;letter-spacing:.5px;color:var(--brand);margin:0}
    .brand img{height:48px;border:2px solid var(--line);border-radius:8px}
    nav a{margin-left:16px}
    nav a[aria-current="page"]{text-decoration:underline;text-underline-offset:6px}

    h2.section{display:flex;align-items:center;gap:8px;font-family:'Metal Mania', cursive;margin:14px 0}
    .panel{background:var(--panel);border:1px solid #222a33;border-radius:12px;padding:14px}

    /* Ã¡rea do player (16:9 responsivo) */
    .player{
      position:relative;width:100%;max-width:100%;
      background:#000;border:1px solid #222a33;border-radius:12px;overflow:hidden;
      aspect-ratio:16/9;
    }
    #game{position:absolute;inset:0}

    .controls{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0}
    .controls > *{font:inherit}
    .btn{
      padding:9px 14px;border-radius:10px;border:1px solid #2a3340;background:#171e26;color:#e5e7eb;
      cursor:pointer;transition:transform .08s ease;
    }
    .btn:hover{transform:translateY(-1px)}
    select, input[type="file"]{
      background:#0f141a;color:#e5e7eb;border:1px solid #2a3340;border-radius:10px;padding:9px 10px;
    }
    .muted{color:var(--muted);font-size:.95rem}
    footer{border-top:1px solid #1b222c;color:#9aa4af;padding:24px 0;margin-top:24px}

    /* mobile */
    @media (max-width:620px){
      nav{display:flex;gap:12px}
      .controls{flex-direction:column;align-items:stretch}
      .btn, select, input[type="file"]{width:100%}
    }
  </style>

  <!-- Caminho de dados do EmulatorJS (versÃ£o estÃ¡vel, NÃƒO latest) -->
  <script>
    // Pina numa versÃ£o estÃ¡vel para evitar quebras inesperadas
    const EJS_BASE = "https://cdn.jsdelivr.net/gh/EmulatorJS/EmulatorJS@v2.0.3/";
    window.EJS_pathtodata = EJS_BASE + "data/";
  </script>
</head>
<body>
  <header>
    <div class="wrap" style="display:flex;align-items:center;justify-content:space-between">
      <div class="brand">
        <img src="/assets/logo.jpg" alt="Nagcoop">
        <div>
          <h1>Nagcoop</h1>
          <div class="muted" style="margin-top:-6px">Games & News â€¢ Web Emulator</div>
        </div>
      </div>
      <nav>
        <a href="/">Home</a>
        <a href="/downloads.html">Downloads</a>
        <a href="/emulator.html" aria-current="page">Emulator</a>
        <a href="https://www.youtube.com/@Nagcoop" target="_blank" rel="noopener">YouTube</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section class="panel">
      <h2 class="section">ðŸŽ® Web Emulator</h2>
      <p class="muted" style="margin-top:-4px">
        Use seus prÃ³prios <em>backups</em> (ou homebrews/demos). Nada Ã© enviado ao servidor â€” a ROM roda apenas no seu navegador.
        <br>Para Mega Drive/Genesis, prefira <strong>.bin</strong> ou <strong>.gen</strong> (muitos <code>.md</code> falham).
      </p>

      <div class="controls">
        <label class="muted">Core:</label>
        <select id="core">
          <option value="gba">Game Boy Advance (GBA)</option>
          <option value="segaMD" selected>Sega Mega Drive / Genesis</option>
          <option value="sms">Sega Master System</option>
        </select>

        <input type="file" id="rom" accept=".gba,.bin,.gen,.sms,.rom,.zip" />
        <button class="btn" id="btn-run">Rodar ROM local</button>

        <button class="btn" id="btn-demo">Carregar demo legal</button>
        <button class="btn" id="btn-full">Tela cheia</button>
      </div>

      <div class="player">
        <div id="game"></div>
      </div>
    </section>
  </main>

  <footer class="wrap">Â© 2025 Nagcoop â€¢ Dark theme â€¢ Gamepad na tela habilitado no mobile</footer>

  <script>
    // --------- elementos ----------
    const container = document.getElementById('game');
    const coreSel   = document.getElementById('core');
    const fileInp   = document.getElementById('rom');
    const runBtn    = document.getElementById('btn-run');
    const demoBtn   = document.getElementById('btn-demo');
    const fullBtn   = document.getElementById('btn-full');

    // Demos pequenas e legais para testar
    const DEMOS = {
      gba:    "https://cdn.jsdelivr.net/gh/thiagola92/gbajs-demos@master/roms/FlappyBird.gba",
      segaMD: "https://cdn.jsdelivr.net/gh/EmulatorJS/EmulatorJS@gh-pages/roms/megadrive/Columns (World).bin",
      sms:    "https://cdn.jsdelivr.net/gh/EmulatorJS/EmulatorJS@gh-pages/roms/mastersystem/Snail Maze (World).sms"
    };

    // mata instÃ¢ncia anterior e limpa player
    function resetPlayer() {
      container.innerHTML = "";
      const old = document.getElementById("ejs-script");
      if (old) old.remove();
    }

    // inicia emulador
    function startEmu(romUrl, core, gameName = "") {
      resetPlayer();

      window.EJS_player        = "#game";
      window.EJS_core          = core;                 // 'gba' | 'segaMD' | 'sms'
      window.EJS_gameUrl       = romUrl;
      window.EJS_gameName      = gameName || undefined;
      window.EJS_startOnLoaded = true;
      window.EJS_color         = "#111";
      window.EJS_onError       = (err) => {
        console.error(err);
        alert(
          "NÃ£o foi possÃ­vel iniciar o emulador.\n\nDicas:\n" +
          "â€¢ GBA: .gba\n" +
          "â€¢ Mega Drive/Genesis: .bin ou .gen (evite .md)\n" +
          "â€¢ Master System: .sms\n\n" +
          "Tente carregar a demo para validar o core."
        );
      };

      const s = document.createElement("script");
      s.src = EJS_BASE + "emulator.js";
      s.id  = "ejs-script";
      document.body.appendChild(s);
    }

    // ROM local
    runBtn.addEventListener("click", () => {
      const f = fileInp.files && fileInp.files[0];
      if (!f) {
        alert("Escolha primeiro um arquivo de ROM.\n\nGBA: .gba â€¢ Mega Drive: .bin/.gen (evite .md) â€¢ Master System: .sms");
        return;
      }
      const url = URL.createObjectURL(f);
      startEmu(url, coreSel.value, f.name);
    });

    // Demo do core
    demoBtn.addEventListener("click", () => {
      const core = coreSel.value;
      const url  = DEMOS[core];
      if (!url) return alert("Sem demo para este core.");
      startEmu(url, core);
    });

    // Tela cheia
    fullBtn.addEventListener("click", () => {
      const el = container.parentElement; // .player
      if (el.requestFullscreen) el.requestFullscreen();
      else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
      else if (el.msRequestFullscreen) el.msRequestFullscreen();
    });

    // trava rolagem em fullscreen no mobile
    document.addEventListener('fullscreenchange', () => {
      document.body.style.overflow = document.fullscreenElement ? 'hidden' : '';
    });
  </script>
</body>
</html>
